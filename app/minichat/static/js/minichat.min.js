function minichat_interval_helper(i){minichat_timer_enabled=i,i?minichat_timer=setInterval(minichat_refresh,minichat_timer_delay):clearInterval(minichat_timer)}function minichat_toggle_notification(i){i?$(minichat_disconnected).hide():$(minichat_disconnected).show(),minichat_interval_helper(!i)}function minichat_init_display(i,t){minichat_content=i,minichat_content_url=t,minichat_interval_helper(!0),minichat_refresh()}function minichat_init_ws(){setTimeout(function(){minichat_timer_enabled&&minichat_toggle_notification(!1)},5e3),$(minichat_disconnected).hide()}function minichat_refresh(){$.get(minichat_content_url,function(i){$(minichat_content).html(i),replace_invalid_avatar($(minichat_content)),activate_tooltips($(minichat_content))})}function minichat_init_post(){minichat_post_url=$(minichat_form).attr("action"),$(minichat_button).click(function(i){i.preventDefault(),$(minichat_button).find("span").addClass("fa-spinner fa-spin"),minichat_post_message()})}function minichat_post_message(){$.post(minichat_post_url,$(minichat_form).serialize()).done(function(i){$(minichat_button).find("span").removeClass("fa-spinner fa-spin fa-warning btn-warning"),$(minichat_input_text).val(""),minichat_update_chars_count(),1==minichat_timer_enabled&&(console.log("Legacy mode enabled, refreshing"),minichat_refresh())}).fail(function(i){$(minichat_button).find("span").removeClass("fa-spinner fa-spin").addClass("fa-warning")})}function minichat_update_chars_count(){var i=$(minichat_input_text).attr("maxlength")-$(minichat_input_text).val().length,t=""
i>1&&(t="s"),$(minichat_input_text).parent().toggleClass("has-warning",0==i),$(minichat_chars_output).text(i+"  caract√®re"+t+" restant"+t)}function minichat_init_remaining_chars(){minichat_update_chars_count(),$(minichat_input_text).change(minichat_update_chars_count),$(minichat_input_text).keyup(minichat_update_chars_count)}function minichat_websocket_onOpen(){minichat_refresh(),minichat_toggle_notification(!0)}function minichat_websocket_onClose(){setTimeout(function(){minichat_timer_enabled&&minichat_toggle_notification(!1)},1e3)}function minichat_websocket_receiveMessage(i){minichat_refresh()}var minichat_timer_delay=3e4,minichat_content,minichat_content_url,minichat_post_url,minichat_timer,minichat_timer_enabled=!1,minichat_form="#minichat_form",minichat_status="#minichat_status",minichat_status_icon="#minichat_status span",minichat_button="#minichat_form button[type='submit']",minichat_input_text="#minichat_form input[type='text']",minichat_chars_output="#minichat_form .minichat-remainingChars",minichat_disconnected="#degraded_connection"
